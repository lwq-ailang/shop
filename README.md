##项目结构：
    shop-parent：父工程
    shop-common：工具工程
    shop-api：接口层
    shop-pojo：实体类
    shop-order-web：订单系统
    shop-pay-web：支付系统
    shop-coupon-service：优惠券服务
    shop-goods-service：商品服务
    shop-user-service：用户服务
    shop-order-service：订单服务
    shop-pay-service：支付服务
    

####1.校验订单
    1)校验订单是否存在：判断订单参数是否为空
    2)校验订单中的商品是否存在：根据订单传来的商品id查询商品是否存在
    3)校验下单用户是否存在：根据订单传来的用户id查询用户是否存在
    4)校验商品单价是否合法：商品单价 ？ 订单单价
    5)校验订单商品数量是否合法：商品数量 ？ 订单数量

####2.生成预订单
    1)设置订单状态为不可见
    2)设置订单ID：使用雪花算法，防止分库分表订单id重复
    3)核算订单运费：订单传进来的运费 ？ 计算订单所需要的运费（可以根据数量，价格等自定义规则）
    4)核算订单总金额是否合法：订单总金额 ？ 订单总价 + 运费价格
    5)判断用户是否使用余额：余额是否足够
    6)判断用户是否使用优惠券：优惠券是否合法
    7)核算订单支付金额：订单总金额 - 余额 - 优惠券金额
    8)设置下单时间
    9)保存订单到数据库
    10)返回订单ID

####3.扣减库存
    1)对比库存数量是否足够
    2)若扣减成功，则更新商品的库存数量和记录到订单商品日志表(订单id，商品id，商品数量等)

####4.扣减优惠券
    1)校验订单中是否包含优惠券id
    2)更新优惠券状态

####5.使用余额
    1)校验订单中余额是否合法
    2)设置用户余额日志表对象[注意：日志类型 1订单付款 2 订单退款]
    3)根据用户id和订单id去余额使用日志查询订单，判断日志中是否有该用户的订单记录
    4)付款-扣减余额（若订单记录>0，已经付款；否则更新用户余额）
    5)退款-回退余额（若订单记录<0,订单未付款；否则更新用户余额）,防止多次退款，需要再次查询余额使用日志表的订单状态
    6)记录到用户余额日志表

####6.确认订单
    1)更新最终订单成功，返回成功状态

####注意：保证原子性：3,4,5,6,7保持一致性，一起成功，一起失败

####8.确认订单失败,往MQ发送消息

####9.返回失败状态
